class G{constructor(t){this.properties=t??[]}get(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.value);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}getString(t){return this.getByType(t,"string")}getNumber(t){return this.getByType(t,"number")}getBoolean(t){return this.getByType(t,"boolean")}getByType(t,o){const n=this.get(t);if(n!==void 0){if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}}mustGetString(t){return this.mustGetByType(t,"string")}mustGetNumber(t){return this.mustGetByType(t,"number")}mustGetBoolean(t){return this.mustGetByType(t,"boolean")}mustGetByType(t,o){const n=this.get(t);if(n===void 0)throw new Error('Property "'+t+'" is missing');if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}getType(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.type);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}}const K="https://unpkg.com/@workadventure/scripting-api-extra@1.4.6/dist";class de{constructor(t){this.name=t.name,this.x=t.x,this.y=t.y,this.properties=new G(t.properties)}get isReadable(){const t=this.properties.getString("readableBy");return t?WA.player.tags.includes(t):!0}get isWritable(){const t=this.properties.getString("writableBy");return t?WA.player.tags.includes(t):!0}}function Z(e){const t=e?"#"+e.join():"";WA.nav.openCoWebSite(K+"/configuration.html"+t)}async function he(e,t){const o=await WA.room.getTiledMap(),n=new Map;return re(o.layers,n,e,t),n}function re(e,t,o,n){for(const a of e)if(a.type==="objectgroup"){for(const r of a.objects)if(r.type==="variable"||r.class==="variable"){if(o&&a.name!==o||n&&!n.includes(r.name))continue;t.set(r.name,new de(r))}}else a.type==="group"&&re(a.layers,t,o,n)}let q;async function j(){return q===void 0&&(q=fe()),q}async function fe(){return ye(await WA.room.getTiledMap())}function ye(e){const t=new Map;return se(e.layers,"",t),t}function se(e,t,o){for(const n of e)n.type==="group"?se(n.layers,t+n.name+"/",o):(n.name=t+n.name,o.set(n.name,n))}async function ge(){const e=await j(),t=[];for(const o of e.values())if(o.type==="objectgroup")for(const n of o.objects)(n.type==="area"||n.class==="area")&&t.push(n);return t}function be(e){let t=1/0,o=1/0,n=0,a=0;const r=e.data;if(typeof r=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let s=0;s<e.height;s++)for(let i=0;i<e.width;i++)r[i+s*e.width]!==0&&(t=Math.min(t,i),a=Math.max(a,i),o=Math.min(o,s),n=Math.max(n,s));return{top:o,left:t,right:a+1,bottom:n+1}}function ie(e){let t=1/0,o=1/0,n=0,a=0;for(const r of e){const s=be(r);s.left<t&&(t=s.left),s.top<o&&(o=s.top),s.right>a&&(a=s.right),s.bottom>n&&(n=s.bottom)}return{top:o,left:t,right:a,bottom:n}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var me=Object.prototype.toString,T=Array.isArray||function(t){return me.call(t)==="[object Array]"};function Y(e){return typeof e=="function"}function Ae(e){return T(e)?"array":typeof e}function H(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function J(e,t){return e!=null&&typeof e=="object"&&t in e}function We(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var we=RegExp.prototype.test;function ve(e,t){return we.call(e,t)}var Se=/\S/;function Pe(e){return!ve(Se,e)}var Me={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Ce(e){return String(e).replace(/[&<>"'`=\/]/g,function(o){return Me[o]})}var Le=/\s*/,Ee=/\s+/,Q=/\s*=/,ke=/\s*\}/,xe=/#|\^|\/|>|\{|&|=|!/;function Te(e,t){if(!e)return[];var o=!1,n=[],a=[],r=[],s=!1,i=!1,l="",f=0;function b(){if(s&&!i)for(;r.length;)delete a[r.pop()];else r=[];s=!1,i=!1}var v,P,U;function I(L){if(typeof L=="string"&&(L=L.split(Ee,2)),!T(L)||L.length!==2)throw new Error("Invalid tags: "+L);v=new RegExp(H(L[0])+"\\s*"),P=new RegExp("\\s*"+H(L[1])),U=new RegExp("\\s*"+H("}"+L[1]))}I(t||w.tags);for(var d=new V(e),M,A,S,B,D,E;!d.eos();){if(M=d.pos,S=d.scanUntil(v),S)for(var N=0,pe=S.length;N<pe;++N)B=S.charAt(N),Pe(B)?(r.push(a.length),l+=B):(i=!0,o=!0,l+=" "),a.push(["text",B,M,M+1]),M+=1,B===`
`&&(b(),l="",f=0,o=!1);if(!d.scan(v))break;if(s=!0,A=d.scan(xe)||"name",d.scan(Le),A==="="?(S=d.scanUntil(Q),d.scan(Q),d.scanUntil(P)):A==="{"?(S=d.scanUntil(U),d.scan(ke),d.scanUntil(P),A="&"):S=d.scanUntil(P),!d.scan(P))throw new Error("Unclosed tag at "+d.pos);if(A==">"?D=[A,S,M,d.pos,l,f,o]:D=[A,S,M,d.pos],f++,a.push(D),A==="#"||A==="^")n.push(D);else if(A==="/"){if(E=n.pop(),!E)throw new Error('Unopened section "'+S+'" at '+M);if(E[1]!==S)throw new Error('Unclosed section "'+E[1]+'" at '+M)}else A==="name"||A==="{"||A==="&"?i=!0:A==="="&&I(S)}if(b(),E=n.pop(),E)throw new Error('Unclosed section "'+E[1]+'" at '+d.pos);return Be(Ie(a))}function Ie(e){for(var t=[],o,n,a=0,r=e.length;a<r;++a)o=e[a],o&&(o[0]==="text"&&n&&n[0]==="text"?(n[1]+=o[1],n[3]=o[3]):(t.push(o),n=o));return t}function Be(e){for(var t=[],o=t,n=[],a,r,s=0,i=e.length;s<i;++s)switch(a=e[s],a[0]){case"#":case"^":o.push(a),n.push(a),o=a[4]=[];break;case"/":r=n.pop(),r[5]=a[2],o=n.length>0?n[n.length-1][4]:t;break;default:o.push(a)}return t}function V(e){this.string=e,this.tail=e,this.pos=0}V.prototype.eos=function(){return this.tail===""};V.prototype.scan=function(t){var o=this.tail.match(t);if(!o||o.index!==0)return"";var n=o[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};V.prototype.scanUntil=function(t){var o=this.tail.search(t),n;switch(o){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,o),this.tail=this.tail.substring(o)}return this.pos+=n.length,n};function x(e,t){this.view=e,this.cache={".":this.view},this.parent=t}x.prototype.push=function(t){return new x(t,this)};x.prototype.lookup=function(t){var o=this.cache,n;if(o.hasOwnProperty(t))n=o[t];else{for(var a=this,r,s,i,l=!1;a;){if(t.indexOf(".")>0)for(r=a.view,s=t.split("."),i=0;r!=null&&i<s.length;)i===s.length-1&&(l=J(r,s[i])||We(r,s[i])),r=r[s[i++]];else r=a.view[t],l=J(a.view,t);if(l){n=r;break}a=a.parent}o[t]=n}return Y(n)&&(n=n.call(this.view)),n};function m(){this.templateCache={_cache:{},set:function(t,o){this._cache[t]=o},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}m.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};m.prototype.parse=function(t,o){var n=this.templateCache,a=t+":"+(o||w.tags).join(":"),r=typeof n<"u",s=r?n.get(a):void 0;return s==null&&(s=Te(t,o),r&&n.set(a,s)),s};m.prototype.render=function(t,o,n,a){var r=this.getConfigTags(a),s=this.parse(t,r),i=o instanceof x?o:new x(o,void 0);return this.renderTokens(s,i,n,t,a)};m.prototype.renderTokens=function(t,o,n,a,r){for(var s="",i,l,f,b=0,v=t.length;b<v;++b)f=void 0,i=t[b],l=i[0],l==="#"?f=this.renderSection(i,o,n,a,r):l==="^"?f=this.renderInverted(i,o,n,a,r):l===">"?f=this.renderPartial(i,o,n,r):l==="&"?f=this.unescapedValue(i,o):l==="name"?f=this.escapedValue(i,o,r):l==="text"&&(f=this.rawValue(i)),f!==void 0&&(s+=f);return s};m.prototype.renderSection=function(t,o,n,a,r){var s=this,i="",l=o.lookup(t[1]);function f(P){return s.render(P,o,n,r)}if(l){if(T(l))for(var b=0,v=l.length;b<v;++b)i+=this.renderTokens(t[4],o.push(l[b]),n,a,r);else if(typeof l=="object"||typeof l=="string"||typeof l=="number")i+=this.renderTokens(t[4],o.push(l),n,a,r);else if(Y(l)){if(typeof a!="string")throw new Error("Cannot use higher-order sections without the original template");l=l.call(o.view,a.slice(t[3],t[5]),f),l!=null&&(i+=l)}else i+=this.renderTokens(t[4],o,n,a,r);return i}};m.prototype.renderInverted=function(t,o,n,a,r){var s=o.lookup(t[1]);if(!s||T(s)&&s.length===0)return this.renderTokens(t[4],o,n,a,r)};m.prototype.indentPartial=function(t,o,n){for(var a=o.replace(/[^ \t]/g,""),r=t.split(`
`),s=0;s<r.length;s++)r[s].length&&(s>0||!n)&&(r[s]=a+r[s]);return r.join(`
`)};m.prototype.renderPartial=function(t,o,n,a){if(n){var r=this.getConfigTags(a),s=Y(n)?n(t[1]):n[t[1]];if(s!=null){var i=t[6],l=t[5],f=t[4],b=s;l==0&&f&&(b=this.indentPartial(s,f,i));var v=this.parse(b,r);return this.renderTokens(v,o,n,b,a)}}};m.prototype.unescapedValue=function(t,o){var n=o.lookup(t[1]);if(n!=null)return n};m.prototype.escapedValue=function(t,o,n){var a=this.getConfigEscape(n)||w.escape,r=o.lookup(t[1]);if(r!=null)return typeof r=="number"&&a===w.escape?String(r):a(r)};m.prototype.rawValue=function(t){return t[1]};m.prototype.getConfigTags=function(t){return T(t)?t:t&&typeof t=="object"?t.tags:void 0};m.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!T(t))return t.escape};var w={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){O.templateCache=e},get templateCache(){return O.templateCache}},O=new m;w.clearCache=function(){return O.clearCache()};w.parse=function(t,o){return O.parse(t,o)};w.render=function(t,o,n,a){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Ae(t)+'" was given as the first argument for mustache#render(template, view, partials)');return O.render(t,o,n,a)};w.escape=Ce;w.Scanner=V;w.Context=x;w.Writer=m;class le{constructor(t,o){this.template=t,this.state=o,this.ast=w.parse(t)}getValue(){return this.value===void 0&&(this.value=w.render(this.template,this.state)),this.value}onChange(t){const o=[];for(const n of this.getUsedVariables().values())o.push(this.state.onVariableChange(n).subscribe(()=>{const a=w.render(this.template,this.state);a!==this.value&&(this.value=a,t(this.value))}));return{unsubscribe:()=>{for(const n of o)n.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const t=new Set;return this.recursiveGetUsedVariables(this.ast,t),t}recursiveGetUsedVariables(t,o){for(const n of t){const a=n[0],r=n[1],s=n[4];["name","&","#","^"].includes(a)&&o.add(r),s!==void 0&&typeof s!="string"&&this.recursiveGetUsedVariables(s,o)}}}async function Re(){var e;const t=await ge();for(const o of t){const n=(e=o.properties)!==null&&e!==void 0?e:[];for(const a of n){if(a.type==="int"||a.type==="bool"||a.type==="object"||typeof a.value!="string")continue;const r=new le(a.value,WA.state);if(r.isPureString())continue;const s=r.getValue();await ee(o.name,a.name,s),r.onChange(async i=>{await ee(o.name,a.name,i)})}}}async function ze(){var e;const t=await j();for(const[o,n]of t.entries())if(n.type!=="objectgroup"){const a=(e=n.properties)!==null&&e!==void 0?e:[];for(const r of a){if(r.type==="int"||r.type==="bool"||r.type==="object"||typeof r.value!="string")continue;const s=new le(r.value,WA.state);if(s.isPureString())continue;const i=s.getValue();te(o,r.name,i),s.onChange(l=>{te(o,r.name,l)})}}}async function ee(e,t,o){console.log(e),(await WA.room.area.get(e)).setProperty(t,o)}function te(e,t,o){WA.room.setProperty(e,t,o),t==="visible"&&(o?WA.room.showLayer(e):WA.room.hideLayer(e))}let $,X=0,F=0;function oe(e){if(WA.state[e.name]){let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.showLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.hideLayer(o)}else{let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.hideLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.showLayer(o)}}function Ge(e){const t=e.properties.getString("openSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const a=ce(e.properties.mustGetString("openLayer").split(`
`));if(a>o)return;n=1-a/o}t&&WA.sound.loadSound(t).play({volume:n})}function Oe(e){const t=e.properties.getString("closeSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const a=ce(e.properties.mustGetString("closeLayer").split(`
`));if(a>o)return;n=1-a/o}t&&WA.sound.loadSound(t).play({volume:n})}function ue(e){return e.map(t=>$.get(t)).filter(t=>(t==null?void 0:t.type)==="tilelayer")}function ce(e){const t=ue(e),o=ie(t),n=((o.right-o.left)/2+o.left)*32,a=((o.bottom-o.top)/2+o.top)*32;return Math.sqrt(Math.pow(X-n,2)+Math.pow(F-a,2))}function je(e){WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]?Ge(e):Oe(e),oe(e)}),oe(e)}function Ve(e,t,o,n){const a=e.name;let r,s,i=!1;const l=o.getString("tag");let f=!0;l&&!WA.player.tags.includes(l)&&(f=!1);const b=!!l;function v(){var d;r&&r.remove(),r=WA.ui.displayActionMessage({message:(d=o.getString("closeTriggerMessage"))!==null&&d!==void 0?d:"Press SPACE to close the door",callback:()=>{WA.state[t.name]=!1,P()}})}function P(){var d;r&&r.remove(),r=WA.ui.displayActionMessage({message:(d=o.getString("openTriggerMessage"))!==null&&d!==void 0?d:"Press SPACE to open the door",callback:()=>{WA.state[t.name]=!0,v()}})}function U(d){const M=ie(ue(t.properties.mustGetString("closeLayer").split(`
`)));s=WA.room.website.create({name:"doorKeypad"+d,url:n+"/keypad.html#"+encodeURIComponent(d),position:{x:M.right*32,y:M.top*32,width:32*3,height:32*4},allowApi:!0})}function I(){s&&(WA.room.website.delete(s.name),s=void 0)}WA.room.onEnterLayer(a).subscribe(()=>{if(i=!0,o.getBoolean("autoOpen")&&f){WA.state[t.name]=!0;return}if(!WA.state[t.name]&&(b&&!f||!b)&&(o.getString("code")||o.getString("codeVariable"))){U(a);return}f&&(WA.state[t.name]?v():P())}),WA.room.onLeaveLayer(a).subscribe(()=>{i=!1,o.getBoolean("autoClose")&&(WA.state[t.name]=!1),r&&r.remove(),I()}),WA.state.onVariableChange(t.name).subscribe(()=>{i&&(!o.getBoolean("autoClose")&&WA.state[t.name]===!0&&v(),s&&WA.state[t.name]===!0&&I(),!o.getBoolean("autoOpen")&&WA.state[t.name]===!1&&P())})}function Ue(e){const t=e.properties.mustGetString("bellSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const a=Math.sqrt(Math.pow(e.x-X,2)+Math.pow(e.y-F,2));if(a>o)return;n=1-a/o}WA.sound.loadSound(t).play({volume:n})}function De(e){WA.state[e.name]===void 0&&(WA.state[e.name]=0),WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]&&Ue(e)})}function _e(e,t,o){let n;const a=t.getString("bellPopup");WA.room.onEnterLayer(o).subscribe(()=>{var r;a?n=WA.ui.openPopup(a,"",[{label:(r=t.getString("bellButtonText"))!==null&&r!==void 0?r:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.onLeaveLayer(o).subscribe(()=>{n&&(n.close(),n=void 0)})}async function Ne(e){e=e??K;const t=await he();$=await j();for(const o of t.values())o.properties.get("door")&&je(o),o.properties.get("bell")&&De(o);for(const o of $.values()){const n=new G(o.properties),a=n.getString("doorVariable");if(a&&o.type==="tilelayer"){const s=t.get(a);if(s===void 0)throw new Error('Cannot find variable "'+a+'" referred in the "doorVariable" property of layer "'+o.name+'"');Ve(o,s,n,e)}const r=n.getString("bellVariable");r&&_e(r,n,o.name)}WA.player.onPlayerMove(o=>{X=o.x,F=o.y})}function qe(e,t){const o=e.getString("bindVariable");if(o){const n=e.get("enterValue"),a=e.get("leaveValue"),r=e.getString("triggerMessage"),s=e.getString("tag");He(o,t,n,a,r,s)}}function He(e,t,o,n,a,r){r&&!WA.player.tags.includes(r)||(o!==void 0&&WA.room.onEnterLayer(t).subscribe(()=>{a||(WA.state[e]=o)}),n!==void 0&&WA.room.onLeaveLayer(t).subscribe(()=>{WA.state[e]=n}))}async function $e(){const e=await j();for(const t of e.values()){const o=new G(t.properties);qe(o,t.name)}}let ne;async function Ke(e){const t=await WA.room.getTiledMap();e=e??K,ne=await j();const o=t.layers.find(n=>n.name==="configuration");if(o){const a=new G(o.properties).getString("tag");(!a||WA.player.tags.includes(a))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(e+"/configuration.html",!0)});for(const r of ne.values()){const s=new G(r.properties),i=s.getString("openConfig");i&&r.type==="tilelayer"&&Ye(i.split(","),r.name,s)}}}function Ye(e,t,o){let n;const a=o.getString("openConfigAdminTag");let r=!0;a&&!WA.player.tags.includes(a)&&(r=!1);function s(){var l;n&&n.remove(),n=WA.ui.displayActionMessage({message:(l=o.getString("openConfigTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE or touch here to configure",callback:()=>Z(e)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(t).subscribe(()=>{const l=o.getString("openConfigTrigger");r&&(l&&l==="onaction"?s():Z(e))}),WA.room.onLeaveLayer(t).subscribe(()=>{n&&n.remove(),i()})}function Xe(){return WA.onInit().then(()=>{Ne().catch(e=>console.error(e)),$e().catch(e=>console.error(e)),Ke().catch(e=>console.error(e)),ze().catch(e=>console.error(e)),Re().catch(e=>console.error(e))}).catch(e=>console.error(e))}console.log("Script started successfully");let W,_,y,h,u=0,c=0,k,R=0,z=0;const Fe=/Mobi|Android|iPhone/i.test(navigator.userAgent);WA.onInit().then(()=>{console.log("Scripting API ready"),console.log("Player tags: ",WA.player.tags),WA.room.hideLayer("monsterlab"),WA.room.area.onEnter("sfire").subscribe(()=>{h=WA.sound.loadSound("sound/fire2.wav").play(p)}),WA.room.area.onLeave("sfire").subscribe(()=>{ae()}),WA.room.area.onEnter("npcpiratezone").subscribe(()=>{W=WA.ui.openPopup("npcpiratepopup","CAPTAIN BOTTLE-TOP: Welcome on board, mate! Our spaceship crashed on this Unknown Planet, and we must find our way back home! I learned that we must solve the riddles to defeat the Force of the Unknown Planet and get our spaceship free to go back home!Lets do this!",[]);var e=WA.sound.loadSound("sound/npc/pirate.wav");e.play(p)}),WA.room.area.onLeave("npcpiratezone").subscribe(C),WA.room.area.onEnter("npcrobotzone").subscribe(()=>{W=WA.ui.openPopup("npcrobotpopup","IRON SAMSON: Excellent! Did you complete the task? I don't know, and I don't care. Now, enter your answers into the terminal, and I'll see if you did the task right. Hope you remember how to use a keyboard, ha-ha-ha!",[]);var e=WA.sound.loadSound("sound/npc/robot.mp3");e.play(p)}),WA.room.area.onLeave("npcrobotzone").subscribe(C),WA.room.area.onEnter("npcadminzone").subscribe(()=>{W=WA.ui.openPopup("npcadmin1popup","BoJack: Did you notice the violation? Lets ban him?",[]),_=WA.ui.openPopup("npcadmin2popup","Zaragossa: I'll keep an eye on him from an ambush...",[]);var e=WA.sound.loadSound("sound/npc/horse.mp3");e.play(p);var t=WA.sound.loadSound("sound/npc/mouse.mp3");t.play(p)}),WA.room.area.onLeave("npcadminzone").subscribe(C),WA.room.area.onLeave("npcadminzone").subscribe(Ze),WA.room.area.onEnter("npcpidginzone").subscribe(()=>{W=WA.ui.openPopup("npcpidginpopup","FLIPPER: Hello! I find myself in a strange place surrounded by ancient Egyptian pyramids, and I feel that there are secrets hidden behind them that no one has yet uncovered. Can you help me find the answer to what lies behind these images?",[]);var e=WA.sound.loadSound("sound/npc/pidgin.mp3");e.play(p)}),WA.room.area.onLeave("npcpidginzone").subscribe(C),WA.room.area.onEnter("npcfrogzone").subscribe(()=>{W=WA.ui.openPopup("npcfrogpopup","FROG: Hey, help me out here! The horse and quokka are making me spin this wheel to generate energy for the server.",[]);var e=WA.sound.loadSound("sound/npc/frog.mp3");e.play(p)}),WA.room.area.onLeave("npcfrogzone").subscribe(C),WA.room.area.onEnter("npcpanda").subscribe(()=>{W=WA.ui.openPopup("npcpandapopup","Friend, don't ask me about Sei, better find me a bamboo.",[]);var e=WA.sound.loadSound("sound/npc/panda.mp3");e.play(p)}),WA.room.area.onLeave("npcpanda").subscribe(C),WA.room.area.onEnter("npcjay").subscribe(()=>{W=WA.ui.openPopup("npcjaypopup","Are you hungry? Sei no more - your food is not here!",[]);var e=WA.sound.loadSound("sound/npc/meat.mp3");e.play(p)}),WA.room.area.onLeave("npcjay").subscribe(C),WA.room.area.onEnter("bubble").subscribe(()=>{var e=WA.sound.loadSound("sound/npc/bubble.mp3");e.play(p),WA.player.onPlayerMove(t=>{u=t.x,c=t.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{var t=WA.sound.loadSound("sound/scan.wav");t.play(p),console.log(u,c),WA.room.website.create({name:"bubblerweb",url:"https://media.discordapp.net/attachments/1081590822379720724/1081947537352699914/bubblers.png?width=596&height=675",position:{x:u+100,y:c-335,width:596,height:675},allowApi:!0})}})}),WA.room.area.onLeave("bubble").subscribe(()=>{g(),WA.room.website.delete("bubblerweb")}),WA.room.area.onEnter("woodenstatue").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1081590822379720724/1081981852493025300/woodenstatue.png?width=596&height=675",position:{x:u+100,y:c-335,width:596,height:675},allowApi:!0})}})}),WA.room.area.onLeave("woodenstatue").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("shark").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1081590822379720724/1081947537843425350/sandshark.png?width=596&height=675",position:{x:u+100,y:c-335,width:596,height:675},allowApi:!0})}})}),WA.room.area.onLeave("shark").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("crystal").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1081590822379720724/1081992872443789373/crystal.png?width=596&height=675",position:{x:u+100,y:c-335,width:596,height:675},allowApi:!0})}})}),WA.room.area.onLeave("crystal").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("twistedtree").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1081590822379720724/1081995416826040361/tree.png?width=596&height=675",position:{x:u+100,y:c-335,width:596,height:675},allowApi:!0})}})}),WA.room.area.onLeave("twistedtree").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("bushes").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1081590822379720724/1082000121409052763/bushes.png?width=596&height=675",position:{x:u+100,y:c-335,width:596,height:675},allowApi:!0})}})}),WA.room.area.onLeave("bushes").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("piramidmain").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545432163340309/1081654218450010243/e2b43b93f01f5797.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("piramidmain").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("piramid1").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545432163340309/1081655031121592320/2.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("piramid1").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("piramid2").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545432163340309/1081655039891865660/3.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("piramid2").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("piramid3").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545432163340309/1081655077820965006/4.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("piramid3").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("piramid4").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545432163340309/1081655106652614746/5.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("piramid4").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("bzzz").subscribe(()=>{var e=WA.sound.loadSound("sound/npc/bzzz.mp3");e.play(p),WA.player.onPlayerMove(t=>{u=t.x,c=t.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{Fe===!1?(h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1081590822379720724/1083454474737168426/04.png?width=596&height=675",position:{x:u+100,y:c-335,width:596,height:675},allowApi:!0})):WA.nav.openTab("https://media.discordapp.net/attachments/1081590822379720724/1083454474737168426/04.png?width=596&height=675")}})}),WA.room.area.onLeave("bzzz").subscribe(()=>{g(),WA.room.website.delete("coWeb"),ae(),WA.player.getWokaPicture().then(()=>{WA.player.getWokaPicture().then(e=>{const t=String(e);console.log(t)})})}),WA.player.onPlayerMove(e=>{u=e.x,c=e.y,k=e.direction}),WA.room.area.onEnter("monster").subscribe(()=>{console.log(u,c,k),WA.controls.disablePlayerControls(),WA.player.setOutlineColor(255,0,0),k==="left"?(console.log("nav is left"),R=u+400,z=c):k==="right"?(R=u-400,z=c,console.log("right")):k==="up"?(z=c+400,R=u,console.log("up")):k==="down"?(z=c-400,R=u,console.log("down")):console.log("error"),WA.room.showLayer("monsterlab"),h=WA.sound.loadSound("sound/lab/fear.wav").play(p),h=WA.sound.loadSound("sound/lab/monster.wav").play(p),setTimeout(()=>{h=WA.sound.loadSound("sound/lab/scream.wav").play(p)},200),WA.player.moveTo(R,z,20),setTimeout(()=>{WA.controls.restorePlayerControls(),WA.player.removeOutlineColor(),WA.room.hideLayer("monsterlab")},2e3)}),WA.room.area.onLeave("monster").subscribe(()=>{}),WA.room.area.onEnter("teleport").subscribe(()=>{h=WA.sound.loadSound("sound/lab/teleport.wav").play(p),WA.nav.goToRoom("https://play.workadventu.re/_/global/pepe17031.github.io/SeiGame/maps/map.tmj#start")}),WA.room.area.onEnter("labword").subscribe(()=>{h=WA.sound.loadSound("sound/lab/win.mp3").play(p),WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545122669834332/1083019062185041971/2_2.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("labword").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("labfrogzone").subscribe(()=>{W=WA.ui.openPopup("labfrog","If you misbehave, I'll eat you like that frog.",[]);var e=WA.sound.loadSound("sound/lab/frog.wav");e.play(p)}),WA.room.area.onLeave("labfrogzone").subscribe(C),WA.room.area.onEnter("labbobrzone").subscribe(()=>{W=WA.ui.openPopup("labbobr","Hey, you won't get any answers from me, don't even think about that. And remember, I'm watching you!",[]);var e=WA.sound.loadSound("sound/lab/bobr.mp3");e.play(p)}),WA.room.area.onLeave("labbobrzone").subscribe(C),WA.room.area.onEnter("npclava1").subscribe(()=>{W=WA.ui.openPopup("npclava1popup","I'm researching these strange statues and noticed that they have symbols engraved on them. I think a word can be formed from them. Solve the anagram, and perhaps we'll discover the secrets of this planet.",[]);var e=WA.sound.loadSound("sound/npc/wizardlava.wav");e.play(p),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{h=WA.sound.loadSound("sound/scan.wav").play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545477625380936/1088846637566267533/all.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("npclava1").subscribe(()=>{g(),C(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("npclava2").subscribe(()=>{W=WA.ui.openPopup("npclava2popup","I'm studying these crystals and discovered that one of them pulses in a strange rhythm. I believe it's a message encoded in Morse code. Decipher it. You can find hints in my library.",[]);var e=WA.sound.loadSound("sound/lava/fire.wav");e.play(p),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to listen stone",callback:()=>{h=WA.sound.loadSound("sound/lava/seim.mp3").play(p)}})}),WA.room.area.onLeave("npclava2").subscribe(()=>{g(),C(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("lavabooks").subscribe(()=>{h=WA.sound.loadSound("sound/lava/book.wav").play(p),WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545477625380936/1088825752327311440/morze.png?width=676&height=676",position:{x:u-800,y:c-435,width:676,height:676},allowApi:!0}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to listen SOS",callback:()=>{h=WA.sound.loadSound("sound/lava/sosm.mp3").play(p)}})}),WA.room.area.onLeave("lavabooks").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("lavaC").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{var e=WA.sound.loadSound("sound/scan.wav");e.play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545477625380936/1088851020504899604/C.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("lavaC").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("lavaO").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{var e=WA.sound.loadSound("sound/scan.wav");e.play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545477625380936/1088851021431840799/o.png?width=911&height=676",position:{x:u-1e3,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("lavaO").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("lavaS").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{var e=WA.sound.loadSound("sound/scan.wav");e.play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545477625380936/1088851021431840799/o.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("lavaS").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),WA.room.area.onEnter("lavaM").subscribe(()=>{WA.player.onPlayerMove(e=>{u=e.x,c=e.y}),y=WA.ui.displayActionMessage({message:"Press the 'SPACE' to scan",callback:()=>{var e=WA.sound.loadSound("sound/scan.wav");e.play(p),WA.room.website.create({name:"coWeb",url:"https://media.discordapp.net/attachments/1080545477625380936/1088851020832047224/m.png?width=911&height=676",position:{x:u+100,y:c-335,width:911,height:676},allowApi:!0})}})}),WA.room.area.onLeave("lavaM").subscribe(()=>{g(),WA.room.website.delete("coWeb")}),Xe().then(()=>{console.log("Scripting API Extra ready")}).catch(e=>console.error(e))}).catch(e=>console.error(e));function C(){W!==void 0&&(W.close(),W=void 0)}function Ze(){_!==void 0&&(_.close(),_=void 0)}function g(){y!==void 0&&(y.remove(),y=void 0)}function ae(){h!==void 0&&(WA.sound.loadSound(h).stop(),h=void 0)}var p={volume:.4,loop:!1,rate:1,detune:1,delay:0,seek:0,mute:!1};
